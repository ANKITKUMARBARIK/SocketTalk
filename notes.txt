ğŸ”¥ WebSockets Kya Hota Hai?
WebSocket ek protocol hai jo allow karta hai full-duplex (2-way) real-time communication client (browser) aur server ke beech â€” bina baar-baar HTTP request bhejne ke.

ğŸ§  Normal HTTP:

Client â†’ Request bhejta hai

Server â†’ Reply deta hai

Har baar naya request-response hota hai

ğŸ§  WebSocket:

Ek hi baar connection banta hai (handshake)

Uske baad dono taraf se bina rukawat message jaa sakte hain (like WhatsApp chat)



ğŸ§  1. WebSocket Upgrade in Networking (Technical Meaning)
Jab tu WebSocket ka use karta hai, tab pehle connection HTTP se start hota hai, phir browser server se kehta hai:

"Bhai, mujhe HTTP nahi, WebSocket chahiye â€” upgrade kar de connection."

Isko hi HTTP Upgrade Request kehte hain.

ğŸ” Yeh Flow hota hai:

Client â†’ Server:
GET /chat HTTP/1.1
Upgrade: websocket
Connection: Upgrade
Host: example.com

Server response:

HTTP/1.1 101 Switching Protocols
Upgrade: websocket
Connection: Upgrade
ğŸŸ¢ Yani 101 status code ka matlab hota hai:

â€œThe protocol is upgraded to WebSocket now.â€




â˜‘ï¸socket.io:

Start karta hai HTTP long polling se

Phir upgrade karta hai WebSocket pe (agar supported ho)

Aur fir deta hai features + fallback + events ğŸ





| Step | Reason |
|------|--------|
| `http.createServer(app)` | Taki `socket.io` ya `ws` module ko **attach** kar paayein |
| `server.listen()`        | Express app + socket server dono run ho sakein |






ğŸ§  Backend Code: index.js

js

const express = require("express");
const http = require("http");
const { Server } = require("socket.io");

ğŸ§¾ Iska matlab:
express â€“ HTTP server banana easy ho jaata hai.
http â€“ Kyunki socket.io ko raw HTTP server chahiye hota hai.
{ Server } = require("socket.io") â€“ Ye socket.io ka backend version hai jisse hum real-time communication karenge.

js

const app = express();
const server = http.createServer(app);
const io = new Server(server);

ğŸ’¡ Yeh teen lines kya karte hain?
app â€“ Express app hai.
http.createServer(app) â€“ Express app ko HTTP server me daal diya (kyunki WebSocket direct express se kaam nahi karta).
new Server(server) â€“ WebSocket server bana diya socket.io ka use karke.

js

app.use(express.static("public"));
ğŸ§¾ Yeh kya karta hai?
"public" naam ke folder ko serve karega â€” yahi frontend ka code hoga (index.html wahan hoga).

js

io.on("connection", (socket) => {
  console.log("ğŸ”Œ User connected:", socket.id);

ğŸ”Œ Matlab:
Jab bhi koi client (browser) connect karega â€” ye connection event chalega.
Har user ka ek unique socket.id hota hai (alag tab, alag browser).

js

  socket.on("chat message", (msg) => {
    console.log("ğŸ’¬", msg);
    io.emit("chat message", msg);  // Sab clients ko bhej diya
  });
ğŸ’¬ Message handling:
Jab client se "chat message" naam ka event aaye, server us message ko console me print karega.

io.emit se sab clients ko message bhej diya jaata hai â€” including sender.

js

  socket.on("disconnect", () => {
    console.log("âŒ Disconnected:", socket.id);
  });
});
ğŸ”Œ Jab client close kare ya net chale jaaye:
disconnect event chal jaata hai.

js

server.listen(3000, () => {
  console.log("ğŸš€ Server running at http://localhost:3000");
});
âœ… Server start ho gaya:
Port 3000 pe tumhara WebSocket + Express server chal raha hoga.

ğŸ’» Frontend Code: public/index.html

html

<script src="/socket.io/socket.io.js"></script>
ğŸ”Œ Is line ka matlab:

Ye script socket.io ka browser wala version load karta hai, bina install kiye.

js

const socket = io(); // Connection server se ban gaya
Ye line socket server se connect kar deti hai automatically.

ğŸ§¾ Form submission:
js

form.addEventListener("submit", (e) => {
  e.preventDefault(); // page reload na ho

  if (input.value) {
    socket.emit("chat message", input.value);  // Server ko bhej diya
    input.value = "";
  }
});
ğŸ” Ye message ko server ko send karta hai chat message naam ke event me.

ğŸ‘‚ Message sunna:
js

socket.on("chat message", (msg) => {
  const li = document.createElement("li");
  li.textContent = msg;
  messages.appendChild(li);
});
Jab server se "chat message" aaye to message screen pe dikhaye.

